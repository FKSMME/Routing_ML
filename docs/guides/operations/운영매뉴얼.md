# Routing ML v4 ìš´ì˜ ë§¤ë‰´ì–¼

**ë²„ì „**: 1.0.0
**ì‘ì„±ì¼**: 2025-10-06
**ëŒ€ìƒ**: ìš´ì˜íŒ€, DevOps, SRE

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì¼ìƒ ìš´ì˜](#ì¼ìƒ-ìš´ì˜)
3. [ëª¨ë‹ˆí„°ë§](#ëª¨ë‹ˆí„°ë§)
4. [ë°±ì—… ë° ë³µêµ¬](#ë°±ì—…-ë°-ë³µêµ¬)
5. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)
6. [ì •ê¸° ì‘ì—…](#ì •ê¸°-ì‘ì—…)
7. [ë¹„ìƒ ì—°ë½ë§](#ë¹„ìƒ-ì—°ë½ë§)

---

## ğŸ¯ ì‹œìŠ¤í…œ ê°œìš”

### ì•„í‚¤í…ì²˜
```
ì‚¬ìš©ì (Browser)
  â†“
Frontend (React + Vite)
  â†“
API Server (FastAPI)
  â†“
ML Model (scikit-learn + HNSW)
  â†“
Database (Access DB)
```

### ì£¼ìš” ì»´í¬ë„ŒíŠ¸
| ì»´í¬ë„ŒíŠ¸ | ì„¤ëª… | í¬íŠ¸ | ìƒíƒœ í™•ì¸ |
|----------|------|------|-----------|
| Frontend (Prediction) | ì˜ˆì¸¡ UI | 5173 | http://localhost:5173 |
| Frontend (Training) | í•™ìŠµ UI | 5174 | http://localhost:5174 |
| Backend API | FastAPI ì„œë²„ | 8000 | http://localhost:8000/api/health |
| Access DB | ë¼ìš°íŒ… ë°ì´í„° | - | íŒŒì¼ ì¡´ì¬ í™•ì¸ |

### ë°°í¬ ìœ„ì¹˜
- **ê°œë°œ**: `/workspaces/Routing_ML_4`
- **ìš´ì˜**: TBD

---

## ğŸ”„ ì¼ìƒ ìš´ì˜

### ì‹œìŠ¤í…œ ì‹œì‘

#### 1. Backend ì‹œì‘
```bash
cd /workspaces/Routing_ML_4
source venv-linux/bin/activate
python -m uvicorn backend.run_api:app --host 0.0.0.0 --port 8000
```

#### 2. Frontend ì‹œì‘ (Prediction)
```bash
cd /workspaces/Routing_ML_4/frontend-prediction
npm run dev
```

#### 3. Frontend ì‹œì‘ (Training)
```bash
cd /workspaces/Routing_ML_4/frontend-training
npm run dev
```

### ì‹œìŠ¤í…œ ì¢…ë£Œ

#### ì •ìƒ ì¢…ë£Œ
```bash
# Frontend (Ctrl+Cë¡œ ì¢…ë£Œ)

# Backend
pkill -f "uvicorn backend.run_api:app"

# ë˜ëŠ” í”„ë¡œì„¸ìŠ¤ ID í™•ì¸ í›„ ì¢…ë£Œ
ps aux | grep uvicorn
kill <PID>
```

#### ê°•ì œ ì¢…ë£Œ (ë¹„ìƒì‹œ)
```bash
pkill -9 -f uvicorn
pkill -9 -f vite
```

### ìƒíƒœ í™•ì¸

#### Health Check
```bash
# API ìƒíƒœ
curl http://localhost:8000/api/health | jq

# ì‘ë‹µ ì˜ˆì‹œ:
# {
#   "status": "healthy",
#   "version": "0.1.0",
#   "uptime_seconds": 3600.5
# }
```

#### í”„ë¡œì„¸ìŠ¤ í™•ì¸
```bash
# ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤
ps aux | grep -E "uvicorn|vite"

# í¬íŠ¸ ì‚¬ìš© í™•ì¸
ss -tuln | grep -E ":(5173|5174|8000)"
```

#### ë¡œê·¸ í™•ì¸
```bash
# Backend ë¡œê·¸
tail -f logs/api.log

# íŠ¹ì • ì—ëŸ¬ ê²€ìƒ‰
grep ERROR logs/api.log | tail -20
```

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§

### Health Check (í•„ìˆ˜)

#### ë§¤ì¼ 09:00 - ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
```bash
curl http://localhost:8000/api/health
```

**ì •ìƒ**: `status: "healthy"`
**ë¹„ì •ìƒ**: `status: "degraded"` ë˜ëŠ” `"unhealthy"`

### Metrics í™•ì¸

#### Prometheus Metrics
```bash
curl http://localhost:8000/api/metrics

# ì£¼ìš” ë©”íŠ¸ë¦­:
# routing_ml_uptime_seconds - ê°€ë™ ì‹œê°„
# routing_ml_requests_total - ì´ ìš”ì²­ ìˆ˜
# routing_ml_errors_total - ì´ ì—ëŸ¬ ìˆ˜
# routing_ml_predictions_total - ì´ ì˜ˆì¸¡ ìˆ˜
```

#### Drift Status
```bash
curl http://localhost:8000/api/drift/status | jq

# drift_detected: trueì¸ ê²½ìš° ì¬í•™ìŠµ í•„ìš”
```

### Grafana ëŒ€ì‹œë³´ë“œ (í–¥í›„)

**URL**: http://grafana.company.com/routing-ml

**ì£¼ìš” íŒ¨ë„**:
1. Request Rate (QPS)
2. Error Rate (%)
3. Prediction Latency (p50, p95, p99)
4. Drift Events (7ì¼)
5. Model Accuracy Trend

### ì•Œë¦¼ ì„¤ì •

#### Slack ì•Œë¦¼
- **Critical**: ì„œë¹„ìŠ¤ ë‹¤ìš´, DB ì—°ê²° ì‹¤íŒ¨
- **Warning**: Drift íƒì§€, ë†’ì€ ì—ëŸ¬ìœ¨ (>5%)
- **Info**: ì¬í•™ìŠµ ì™„ë£Œ, ë³´ì•ˆ ìŠ¤ìº” ê²°ê³¼

---

## ğŸ’¾ ë°±ì—… ë° ë³µêµ¬

### ìë™ ë°±ì—…

#### 1. Access DB ë°±ì—… (ë§¤ì¼ 00:00)
```bash
# Cron job í™•ì¸
crontab -l | grep backup_access_db

# ë°±ì—… íŒŒì¼ ìœ„ì¹˜
ls -lh /mnt/backup/routing_db_*.accdb

# ìµœì‹  ë°±ì—… í™•ì¸
ls -lt /mnt/backup/ | head -5
```

#### 2. ëª¨ë¸ ë°±ì—…
```bash
# ëª¨ë¸ ë””ë ‰í† ë¦¬
ls -lh /workspaces/Routing_ML_4/deliverables/models/

# í™œì„± ëª¨ë¸ í™•ì¸
readlink -f deliverables/models/active
```

### ìˆ˜ë™ ë°±ì—…

#### Access DB
```bash
cp "/mnt/data/routing_data/ROUTING AUTO TEST.accdb" \
   "/mnt/backup/manual_backup_$(date +%Y%m%d_%H%M%S).accdb"
```

#### ì „ì²´ ì‹œìŠ¤í…œ
```bash
# ì½”ë“œ + ì„¤ì •
tar -czf routing_ml_backup_$(date +%Y%m%d).tar.gz \
  --exclude=node_modules \
  --exclude=.venv \
  --exclude=venv-linux \
  /workspaces/Routing_ML_4

# ëª¨ë¸ë§Œ
tar -czf models_backup_$(date +%Y%m%d).tar.gz \
  /workspaces/Routing_ML_4/deliverables/models/
```

### ë³µêµ¬ ì ˆì°¨

#### 1. DB ë³µêµ¬
```bash
# ë°±ì—… íŒŒì¼ í™•ì¸
ls -lh /mnt/backup/routing_db_*.accdb

# ë³µêµ¬ (ìš´ì˜ DB êµì²´)
cp /mnt/backup/routing_db_20251005.accdb \
   "/mnt/data/routing_data/ROUTING AUTO TEST.accdb"

# ê¶Œí•œ í™•ì¸
chmod 644 "/mnt/data/routing_data/ROUTING AUTO TEST.accdb"
```

#### 2. ëª¨ë¸ ë¡¤ë°±
```bash
cd /workspaces/Routing_ML_4/deliverables/models/

# ì´ì „ ëª¨ë¸ë¡œ ë¡¤ë°±
ln -sfn model_20251001_020002 active

# í™•ì¸
ls -la active
```

#### 3. ì „ì²´ ì‹œìŠ¤í…œ ë³µêµ¬
```bash
# ë°±ì—… ì••ì¶• í•´ì œ
tar -xzf routing_ml_backup_20251005.tar.gz -C /tmp/

# í•„ìš”í•œ íŒŒì¼ ë³µì‚¬
cp -r /tmp/workspaces/Routing_ML_4/backend /workspaces/Routing_ML_4/
cp -r /tmp/workspaces/Routing_ML_4/frontend-* /workspaces/Routing_ML_4/

# ì˜ì¡´ì„± ì¬ì„¤ì¹˜
cd /workspaces/Routing_ML_4
source venv-linux/bin/activate
pip install -r requirements.txt

cd frontend-prediction && npm install
cd ../frontend-training && npm install
```

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: API ì„œë²„ ì‘ë‹µ ì—†ìŒ

**ì¦ìƒ**:
```bash
curl http://localhost:8000/api/health
# curl: (7) Failed to connect to localhost port 8000
```

**ì›ì¸**: ì„œë²„ ë‹¤ìš´ ë˜ëŠ” í¬íŠ¸ ì¶©ëŒ

**í•´ê²°**:
```bash
# 1. í”„ë¡œì„¸ìŠ¤ í™•ì¸
ps aux | grep uvicorn

# 2. í¬íŠ¸ í™•ì¸
ss -tuln | grep 8000

# 3. ì„œë²„ ì¬ì‹œì‘
cd /workspaces/Routing_ML_4
source venv-linux/bin/activate
python -m uvicorn backend.run_api:app --host 0.0.0.0 --port 8000

# 4. ë¡œê·¸ í™•ì¸
tail -f logs/api.log
```

### ë¬¸ì œ 2: DB ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ**:
```
ERROR: Could not connect to Access database
```

**ì›ì¸**: DB íŒŒì¼ ì—†ìŒ, ê¶Œí•œ ë¬¸ì œ, ë„¤íŠ¸ì›Œí¬ ì¥ì• 

**í•´ê²°**:
```bash
# 1. íŒŒì¼ ì¡´ì¬ í™•ì¸
ls -lh "/mnt/data/routing_data/ROUTING AUTO TEST.accdb"

# 2. ê¶Œí•œ í™•ì¸
stat "/mnt/data/routing_data/ROUTING AUTO TEST.accdb"

# 3. ë„¤íŠ¸ì›Œí¬ ë§ˆìš´íŠ¸ í™•ì¸ (ë„¤íŠ¸ì›Œí¬ ë“œë¼ì´ë¸Œì¸ ê²½ìš°)
df -h | grep /mnt/data

# 4. ë°±ì—…ì—ì„œ ë³µêµ¬
cp /mnt/backup/routing_db_latest.accdb \
   "/mnt/data/routing_data/ROUTING AUTO TEST.accdb"
```

### ë¬¸ì œ 3: ë†’ì€ ì—ëŸ¬ìœ¨ (>10%)

**ì¦ìƒ**:
```bash
curl http://localhost:8000/api/metrics | grep errors_total
# routing_ml_errors_total 1500
```

**ì›ì¸**: ëª¨ë¸ drift, ë°ì´í„° í’ˆì§ˆ ì €í•˜

**í•´ê²°**:
```bash
# 1. Drift ìƒíƒœ í™•ì¸
curl http://localhost:8000/api/drift/status | jq

# 2. ì¬í•™ìŠµ í•„ìš” ì‹œ
bash scripts/monthly_retrain.sh

# 3. ë°ì´í„° í’ˆì§ˆ í™•ì¸
# (ë¡œì»¬ ì‘ì—… í•„ìš”)
```

### ë¬¸ì œ 4: ëŠë¦° ì‘ë‹µ ì†ë„ (>1s)

**ì¦ìƒ**: ì˜ˆì¸¡ ìš”ì²­ ì‘ë‹µ ì‹œê°„ > 1ì´ˆ

**ì›ì¸**: HNSW ì¸ë±ìŠ¤ í¬ê¸°, ë©”ëª¨ë¦¬ ë¶€ì¡±

**í•´ê²°**:
```bash
# 1. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
free -h
ps aux --sort=-%mem | head -10

# 2. HNSW ì¸ë±ìŠ¤ ì¬êµ¬ì¶•
# (backend/predictor_ml.pyì—ì„œ ef_search íŒŒë¼ë¯¸í„° ì¡°ì •)

# 3. ì„œë²„ ì¬ì‹œì‘
pkill -f uvicorn
python -m uvicorn backend.run_api:app --host 0.0.0.0 --port 8000
```

### ë¬¸ì œ 5: TypeScript ë¹Œë“œ ì—ëŸ¬

**ì¦ìƒ**:
```
npm run build
# ERROR: TS2304: Cannot find name '...'
```

**í•´ê²°**:
```bash
# 1. íƒ€ì… ì¬ìƒì„±
bash scripts/generate_api_types.sh

# 2. node_modules ì¬ì„¤ì¹˜
cd frontend-prediction
rm -rf node_modules package-lock.json
npm install

# 3. íƒ€ì… ì²´í¬
npx tsc --noEmit
```

---

## ğŸ“… ì •ê¸° ì‘ì—…

### ë§¤ì¼

#### 09:00 - ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
```bash
# Health check
curl http://localhost:8000/api/health | jq

# Drift status
curl http://localhost:8000/api/drift/status | jq
```

#### 18:00 - ë¡œê·¸ ë¦¬ë·°
```bash
# ì—ëŸ¬ ë¡œê·¸ í™•ì¸
grep ERROR logs/api.log | tail -50

# ê²½ê³  ë¡œê·¸ í™•ì¸
grep WARNING logs/api.log | tail -50
```

### ë§¤ì£¼

#### ì›”ìš”ì¼ 09:00 - ë³´ì•ˆ ìŠ¤ìº” (ìë™)
```bash
# GitHub Actionsì—ì„œ ìë™ ì‹¤í–‰
# ê²°ê³¼ í™•ì¸: https://github.com/your-repo/security

# ìˆ˜ë™ ì‹¤í–‰:
bash scripts/security_scan.sh
```

#### ê¸ˆìš”ì¼ 17:00 - ì£¼ê°„ ë¦¬ë·°
1. ì™„ë£Œëœ ì‘ì—… ì²´í¬
2. Drift ì´ë²¤íŠ¸ ë¦¬ë·°
3. ì—ëŸ¬ìœ¨ ì¶”ì´ í™•ì¸
4. ë‹¤ìŒ ì£¼ ê³„íš

### ë§¤ì›”

#### 1ì¼ 02:00 - ëª¨ë¸ ì¬í•™ìŠµ (ìë™)
```bash
# Cron jobì—ì„œ ìë™ ì‹¤í–‰
# ë¡œê·¸ í™•ì¸:
cat logs/retraining/retrain_$(date +%Y%m)*.log

# ìˆ˜ë™ ì‹¤í–‰:
bash scripts/monthly_retrain.sh
```

#### ë§ˆì§€ë§‰ ê¸ˆìš”ì¼ - ì›”ê°„ ë¦¬ë·°
1. ROI ì‹¤ì  í™•ì¸
2. ëª¨ë¸ ì •í™•ë„ ì¶”ì´
3. ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘
4. ë‹¤ìŒ ë‹¬ ëª©í‘œ ì„¤ì •

### ë¶„ê¸°ë³„

#### Q1, Q2, Q3, Q4 ë§ˆì§€ë§‰ ì£¼
1. ADR (Architecture Decision Records) ë¦¬ë·°
2. ì‹œìŠ¤í…œ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬
3. ë³´ì•ˆ ê°ì‚¬
4. ë¬¸ì„œ ì—…ë°ì´íŠ¸

---

## ğŸ“ ë¹„ìƒ ì—°ë½ë§

### Tier 1: ìš´ì˜íŒ€
| ì—­í•  | ì´ë¦„ | ì „í™” | ì´ë©”ì¼ | ëŒ€ì‘ ì‹œê°„ |
|------|------|------|--------|-----------|
| ìš´ì˜ ë¦¬ë” | í™ê¸¸ë™ | 010-1234-5678 | ops-lead@company.com | 24/7 |
| DevOps ì—”ì§€ë‹ˆì–´ | ê¹€ì² ìˆ˜ | 010-2345-6789 | devops@company.com | 09:00-18:00 |

### Tier 2: ê°œë°œíŒ€
| ì—­í•  | ì´ë¦„ | ì „í™” | ì´ë©”ì¼ | ëŒ€ì‘ ì‹œê°„ |
|------|------|------|--------|-----------|
| ML ì—”ì§€ë‹ˆì–´ | ë°•ì˜í¬ | 010-3456-7890 | ml-engineer@company.com | 09:00-18:00 |
| ë°±ì—”ë“œ ê°œë°œì | ì´ë¯¼ìˆ˜ | 010-4567-8901 | backend-dev@company.com | 09:00-18:00 |

### Tier 3: ê´€ë¦¬ì
| ì—­í•  | ì´ë¦„ | ì „í™” | ì´ë©”ì¼ | ëŒ€ì‘ ì‹œê°„ |
|------|------|------|--------|-----------|
| CTO | ìµœì˜ìˆ˜ | 010-5678-9012 | cto@company.com | ê¸´ê¸‰ ì‹œ |
| PM | ì •ìˆ˜ì§„ | 010-6789-0123 | pm@company.com | ê¸´ê¸‰ ì‹œ |

### ì—ìŠ¤ì»¬ë ˆì´ì…˜ ê·œì¹™
1. **Severity 1 (Critical)**: ì¦‰ì‹œ Tier 1 â†’ 30ë¶„ ë‚´ í•´ê²° ì•ˆ ë˜ë©´ Tier 2
2. **Severity 2 (High)**: 1ì‹œê°„ ë‚´ Tier 1 â†’ 4ì‹œê°„ ë‚´ í•´ê²° ì•ˆ ë˜ë©´ Tier 2
3. **Severity 3 (Medium)**: ì—…ë¬´ ì‹œê°„ ë‚´ Tier 1
4. **Severity 4 (Low)**: ë‹¤ìŒ ì •ê¸° ì‘ì—… ì‹œ ì²˜ë¦¬

---

## ğŸ“š ì°¸ê³  ë¬¸ì„œ

### ê¸°ìˆ  ë¬¸ì„œ
- [API ë¬¸ì„œ](../api/README.md)
- [ì¬í•´ ë³µêµ¬ ì ˆì°¨](../disaster_recovery.md)
- [ë³´ì•ˆ ìŠ¤ìº” ê°€ì´ë“œ](../security_scanning.md)
- [Concept Drift íƒì§€](../concept_drift_detection.md)

### ê°œë°œ ë¬¸ì„œ
- [ì›”ê°„ ì¬í•™ìŠµ ì„¤ì •](../monthly_retraining_setup.md)
- [OpenAPI íƒ€ì… ìƒì„±](../openapi_type_generation.md)
- [í…Œë§ˆ í† ê¸€ ê°€ì´ë“œ](../theme_toggle_guide.md)

### ê´€ë¦¬ ë¬¸ì„œ
- [ROI ê³„ì‚°ì„œ](../ROI_ê³„ì‚°ì„œ.md)
- [í”„ë¡œì íŠ¸ ë¦¬ìŠ¤í¬ ë¶„ì„](../../í”„ë¡œì íŠ¸_ë¦¬ìŠ¤í¬ë¶„ì„_ë°_ë¹„ì „.md)
- [ê°œì„  ëª©í‘œ ì²´í¬ë¦¬ìŠ¤íŠ¸](../../ê°œì„ ëª©í‘œ_ì²´í¬ë¦¬ìŠ¤íŠ¸.md)

---

## ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì¼ì¼ ì ê²€
- [ ] API Health Check í™•ì¸
- [ ] Drift Status í™•ì¸
- [ ] ì—ëŸ¬ ë¡œê·¸ ë¦¬ë·°
- [ ] ë””ìŠ¤í¬ ìš©ëŸ‰ í™•ì¸ (`df -h`)

### ì£¼ê°„ ì ê²€
- [ ] ë³´ì•ˆ ìŠ¤ìº” ê²°ê³¼ í™•ì¸
- [ ] ë°±ì—… íŒŒì¼ í™•ì¸
- [ ] ì„±ëŠ¥ ë©”íŠ¸ë¦­ ë¦¬ë·°
- [ ] ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘

### ì›”ê°„ ì ê²€
- [ ] ëª¨ë¸ ì¬í•™ìŠµ ë¡œê·¸ í™•ì¸
- [ ] ROI ì‹¤ì  ë¦¬ë·°
- [ ] ë¬¸ì„œ ì—…ë°ì´íŠ¸
- [ ] ë‹¤ìŒ ë‹¬ ê³„íš ìˆ˜ë¦½

---

**ì‘ì„±**: ML Team
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-06
**ë‹¤ìŒ ë¦¬ë·°**: 2025-11-06
**ë²„ì „**: 1.0.0
