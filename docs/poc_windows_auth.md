# Windows 인증 PoC 시나리오 보고서

## 목적
Windows 도메인 계정 기반 로그인 기능의 PoC를 위해 Codex가 직접 시나리오를 수립하고 실행하여 세션 발급, 감사 로그 연동, 폴백 사용자 인증 동작을 검증한다.

## 시나리오 개요
1. 테스트 전용 SHA-256 폴백 사용자를 구성한다.
2. FastAPI 설정 객체(`Settings`)를 주입하여 LDAP 연결 없이 폴백 사용자만 활성화한다.
3. 더미 세션 매니저를 주입한 `WindowsAuthService` 인스턴스를 생성한다.
4. 정상 자격 증명을 사용해 세션이 발급되는지 확인한다.
5. 미등록 사용자가 접근 시 인증이 거부되는지 확인한다.
6. 테스트 실행 로그를 수집하여 결과를 보고한다.

## 실행 절차
- 테스트 스위트: `pytest tests/test_auth_service.py`
- 주요 검증 항목
  - 폴백 사용자 성공 시 세션 토큰/도메인 접두어 부여 확인
  - 미등록 사용자 실패 응답 메시지 검증

## 결과 요약
| 항목 | 기대 동작 | 결과 |
| --- | --- | --- |
| 폴백 사용자 로그인 | 세션 발급 및 도메인 접두어 적용 | ✅ 통과 |
| 미등록 사용자 로그인 | 인증 거부 및 실패 메시지 반환 | ✅ 통과 |

테스트는 모두 성공했으며, 세션 매니저 주입을 통해 인메모리 세션 레코드가 올바르게 기록되는 것을 확인했다. 추가적인 LDAP 서버 연결 없이도 Windows 도메인 접두어 규칙과 감사 로그 경로 구성이 정상 작동함을 확인하였다.

## 후속 조치
- 실제 LDAP 서버 연결 시 TLS 검증 옵션 및 검색 기준(DN) 값을 운영 환경에 맞게 재설정한다.
- 감사 로그 파일(`logs/audit/auth.windows_YYYYMMDD.log`)을 정기적으로 수집하여 인증 내역을 모니터링한다.
