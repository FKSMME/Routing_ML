# PRD: 비관리자 동시 접속 스트레스 감사

**Document ID**: PRD_2025-10-23_non-admin-concurrency-stress-audit  
**Created**: 2025-10-23  
**Priority**: 🚨 HIGH  
**Status**: Draft  
**Related Docs**:  
- Checklist: [docs/planning/CHECKLIST_2025-10-23_non-admin-concurrency-stress-audit.md](CHECKLIST_2025-10-23_non-admin-concurrency-stress-audit.md)  
- Workflow: [.claude/WORKFLOW_DIRECTIVES.md](../../.claude/WORKFLOW_DIRECTIVES.md)

---

## Executive Summary

### Problem Statement
비관리자(일반 사용자) 5명이 동시에 전 페이지(학습, 워크플로, 로그, 관리 제외 영역 등)에 접근하여 CRUD 작업을 수행할 때:
- 상태 동기화 실패, 경합 조건, 트랜잭션 롤백, API 스로틀링 등 **동시성 위험**이 존재한다.
- 현재 코드/문서 기반으로 정량적인 처리량·지연·락 충돌 정보가 부족해 **정책 수립이 어렵다.**
- 비관리자 전용 API/권한 경계가 명확히 검증되지 않으면 **권한 상승 및 데이터 손상** 위험이 있다.

### Goals & Objectives
1. 전체 코드 및 문서를 전수 검사하여 비관리자 동시 접속 시 문제가 될 수 있는 지점을 식별한다.  
2. 정량 지표(요청당 평균 지연, 잠재적 경합 영역 수, 임계 자원 사용량 등)를 산출한다.  
3. 위험 레벨을 분류하고 개선 필요 항목 및 우선순위를 정의한다.  
4. 개선 계획을 이해관계자에게 전달 가능한 보고서 형태로 제공한다.

---

## Requirements

### Functional Requirements
1. **접근 경로 식별**: 비관리자 사용자가 접근하는 모든 페이지·API·백엔드 서비스 경로를 매핑한다.  
2. **경합 지점 분석**: Shared state, DB 트랜잭션, 캐시, 큐 등에서 발생 가능한 Race Condition/Deadlock 후보를 식별한다.  
3. **권한 검증**: 비관리자 요청에서 관리자 전용 리소스가 노출되거나 오용될 가능성 평가.  
4. **에러 처리/재시도 로직**: 동시성으로 인한 실패 시 사용자 경험과 복구 가능성 점검.

### Non-Functional Requirements
- **성능 지표**: 요청 처리량(RPS), 평균/최대 응답 시간, DB 락 대기 시간 등 지표 기반 평가.  
- **안정성**: 동시 요청 시 오류율, 타임아웃 비율 등 정량 정보 제공.  
- **보안**: 토큰/세션 경합, 캐시 데이터 누출 위험 점검.  
- **문서화**: 결과 보고서에 요약·세부 분석·개선 계획 포함.

---

## Solution Approach
1. **아키텍처/문서 수집**: 기존 체크리스트, 권한 매트릭스, 로그 정책 문서 확인.  
2. **코드 정적 분석**: 프론트엔드 스토어/훅, 백엔드 서비스/레포지토리, DB 세션 관리 코드 전수 조사.  
3. **정량 지표 산출**: 로깅/모니터링 설정, 테스트 스크립트, CPU/메모리 임계치 문서에서 값 추출.  
4. **리스크 분류**: 고/중/저 위험군 및 영향도·발생 가능성 매트릭스 작성.  
5. **개선안 도출**: 락 강화, 큐 기반 직렬화, 캐시 무효화, 스로틀링 등 조치 제안.

---

## Phase Breakdown

| Phase | 내용 | Deliverables |
|-------|------|--------------|
| Phase 1 | 정보 수집 및 스코프 정의 | 경로 매핑, 지표 소스 목록 |
| Phase 2 | 코드/문서 전수 검사, 위험 항목 식별 | 정량 지표, 위험 매트릭스 |
| Phase 3 | 개선안 설계 및 보고서 작성 | 최종 보고서, 액션 아이템 |

---

## Success Criteria
1. 전수 검사 결과가 정량 지표와 함께 보고서에 반영됨.  
2. 위험 항목별 우선순위 및 개선안이 명확히 정의됨.  
3. 문서화 산출물(PRD·Checklist·Report·Work History)이 최신 상태로 유지됨.  
4. 이해관계자 리뷰 시 추가 질문 없이 실행 단계로 이동 가능.

---

## Timeline Estimates

| Task | ETA |
|------|-----|
| Phase 1 (정보 수집) | 0.5일 |
| Phase 2 (전수 검사 & 분석) | 1.0일 |
| Phase 3 (보고서 & 개선안) | 0.5일 |

총 2일 (버퍼 포함), 목표 완료일: 2025-10-24

---

## Risks & Mitigations
- **코드 베이스 규모**: 방대한 영역 → 우선 비관리자 경로 중심으로 필터링, 자동 검색 스크립트 활용.  
- **실측 지표 부재**: 로그/모니터링 미구현 시 시뮬레이션 지표 사용, 개선안에 계측 요구 포함.  
- **권한 매트릭스 업데이트 지연**: 분석 즉시 문서화하고 QA/보안팀 공유.  
- **동시성 재현 어려움**: 부하 테스트 스크립트 제안 및 후속 자동화 항목 명시.

---

## Approvals
- Product Owner: _(TBD)_  
- Engineering Lead: _(TBD)_  
- QA Lead: _(TBD)_

**Next Review**: Phase 1 완료 시점 (2025-10-23 오후)
