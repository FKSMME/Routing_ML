# ì¸ì¦ í† í° 401 ì—ëŸ¬ í•´ê²° ê°€ì´ë“œ

**ë‚ ì§œ**: 2025ë…„ 10ì›” 17ì¼
**ë¬¸ì œ**: `/api/predict` ë° `/api/auth/me` ì—”ë“œí¬ì¸íŠ¸ì—ì„œ 401 Unauthorized ì—ëŸ¬ ë°œìƒ

---

## ğŸ” ë¬¸ì œ ì§„ë‹¨

### ìŠ¤í¬ë¦°ìƒ·ì—ì„œ í™•ì¸ëœ ì—ëŸ¬
```
Server response delayed. Please try again in a moment.
ì¸ì¦ í† í°ì´ í•„ìš”í•©ë‹ˆë‹¤

Console Errors:
- :5173/api/predict:1 Failed to load resource: 401 (Unauthorized)
- :5173/api/auth/me:1 Failed to load resource: 401 (Unauthorized)
- ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
```

### ê·¼ë³¸ ì›ì¸
1. **ë°±ì—”ë“œ ì„œë²„ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ** - ê°€ì¥ ê°€ëŠ¥ì„± ë†’ìŒ
2. ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ì¸ì¦ì´ í•„ìš”í•œ API í˜¸ì¶œ
3. ì„¸ì…˜ ì¿ í‚¤ ë§Œë£Œ

---

## âœ… í•´ê²° ë°©ë²•

### 1ë‹¨ê³„: ë°±ì—”ë“œ ì„œë²„ ì‹œì‘ (í•„ìˆ˜)

#### ë°©ë²• 1: ë°°ì¹˜ íŒŒì¼ ì‚¬ìš©
```bash
# CMD ì°½ì—ì„œ ì‹¤í–‰
run_backend_main.bat
```

**í™•ì¸ ì‚¬í•­**:
```
Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
```

#### ë°©ë²• 2: ì„œë²„ ëª¨ë‹ˆí„° ì‚¬ìš©
```bash
dist\RoutingMLMonitor_v5.2.0.exe
```
â†’ "ì„œë²„ ì¼ê´„ì‹œì‘" ë²„íŠ¼ í´ë¦­

### 2ë‹¨ê³„: ë°±ì—”ë“œ ì„œë²„ ì‹¤í–‰ í™•ì¸

#### PowerShellì—ì„œ í…ŒìŠ¤íŠ¸
```powershell
# Health check
Invoke-RestMethod http://localhost:8000/health

# ì˜ˆìƒ ê²°ê³¼
# {
#   "status": "ok",
#   "timestamp": "2025-10-17T..."
# }
```

#### ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸
```
http://localhost:8000/docs
```
â†’ Swagger UIê°€ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ë©´ OK

### 3ë‹¨ê³„: í”„ë¡ íŠ¸ì—”ë“œ ì¬ì‹œì‘ (ê¶Œì¥)

ë°±ì—”ë“œë¥¼ ì‹œì‘í•œ í›„ í”„ë¡ íŠ¸ì—”ë“œë„ ì¬ì‹œì‘í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

```bash
# ê¸°ì¡´ í”„ë¡ íŠ¸ì—”ë“œ ì¢…ë£Œ (Ctrl+C ë˜ëŠ”)
taskkill /F /IM node.exe

# ì¬ì‹œì‘
run_frontend_prediction.bat
```

### 4ë‹¨ê³„: ë¡œê·¸ì¸

1. `http://localhost:5173` ì ‘ì†
2. ë¡œê·¸ì¸ í˜ì´ì§€ê°€ í‘œì‹œë˜ì§€ ì•Šìœ¼ë©´ ì§ì ‘ ì´ë™:
   ```
   http://localhost:5173/login
   ```
3. ê³„ì • ì •ë³´ ì…ë ¥ í›„ ë¡œê·¸ì¸

---

## ğŸ› ï¸ ìƒì„¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: ë°±ì—”ë“œê°€ ì‹œì‘ë˜ì§€ ì•ŠìŒ

**ì¦ìƒ**:
```bash
run_backend_main.bat
# ERROR: Virtual environment not found!
```

**í•´ê²°**:
```bash
# Python ê°€ìƒí™˜ê²½ í™•ì¸
dir .venv\Scripts\python.exe

# ì—†ìœ¼ë©´ ì¬ìƒì„±
python -m venv .venv
.venv\Scripts\pip.exe install -r requirements.txt
```

### ë¬¸ì œ 2: í¬íŠ¸ 8000ì´ ì´ë¯¸ ì‚¬ìš© ì¤‘

**ì¦ìƒ**:
```
ERROR: [Errno 10048] Only one usage of each socket address
```

**í•´ê²°**:
```powershell
# í¬íŠ¸ 8000 ì‚¬ìš© í”„ë¡œì„¸ìŠ¤ í™•ì¸
netstat -ano | findstr :8000

# PID í™•ì¸ í›„ ì¢…ë£Œ (ì˜ˆ: PIDê°€ 12345ì¸ ê²½ìš°)
taskkill /F /PID 12345
```

### ë¬¸ì œ 3: ë¡œê·¸ì¸ í›„ì—ë„ 401 ì—ëŸ¬

**ì¦ìƒ**:
- ë¡œê·¸ì¸ì€ ì„±ê³µí–ˆëŠ”ë° ì—¬ì „íˆ 401 ì—ëŸ¬ ë°œìƒ

**í•´ê²°**:
```javascript
// ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ > Consoleì—ì„œ ì‹¤í–‰
// 1. ì¿ í‚¤ í™•ì¸
document.cookie

// 2. ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í™•ì¸
localStorage

// 3. ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ í™•ì¸
sessionStorage

// 4. ëª¨ë‘ ì‚­ì œ í›„ ì¬ë¡œê·¸ì¸
localStorage.clear();
sessionStorage.clear();
```

ê·¸ í›„:
1. ë¸Œë¼ìš°ì € ìƒˆë¡œê³ ì¹¨ (Ctrl+F5)
2. ì¬ë¡œê·¸ì¸

### ë¬¸ì œ 4: CORS ì—ëŸ¬

**ì¦ìƒ**:
```
Access to XMLHttpRequest at 'http://localhost:8000/api/auth/me'
from origin 'http://localhost:5173' has been blocked by CORS policy
```

**í•´ê²°**:

**íŒŒì¼**: `backend/api/config.py` í™•ì¸

```python
# ì´ë¯¸ ìˆ˜ì •ë˜ì–´ ìˆì–´ì•¼ í•¨
ALLOWED_ORIGINS = [
    "http://localhost:3000",
    "http://localhost:5173",
    "http://localhost:5174",
    "http://10.204.2.28:3000",
    "http://10.204.2.28:5173",
]
```

ë§Œì•½ ì„¤ì •ì´ ì˜ëª»ë˜ì–´ ìˆë‹¤ë©´ ë°±ì—”ë“œ ì¬ì‹œì‘ í•„ìš”.

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ë°±ì—”ë“œ ì—°ê²° í…ŒìŠ¤íŠ¸

```powershell
# 1. Health check
Invoke-RestMethod http://localhost:8000/health

# 2. Swagger UI ì ‘ì†
start http://localhost:8000/docs
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ì¸ì¦ í”Œë¡œìš° í…ŒìŠ¤íŠ¸

1. **ë¡œê·¸ì¸ API í…ŒìŠ¤íŠ¸** (Swagger UI ì‚¬ìš©)
   - `http://localhost:8000/docs` ì ‘ì†
   - `POST /api/auth/login` ì„ íƒ
   - Try it out í´ë¦­
   - ìš”ì²­ Body:
     ```json
     {
       "username": "your_username",
       "password": "your_password"
     }
     ```
   - Execute í´ë¦­
   - **ì˜ˆìƒ ê²°ê³¼**: 200 OK, ì„¸ì…˜ ì¿ í‚¤ ì„¤ì •ë¨

2. **í˜„ì¬ ì‚¬ìš©ì ì¡°íšŒ í…ŒìŠ¤íŠ¸**
   - ë¡œê·¸ì¸ í›„ ë™ì¼í•œ Swagger UIì—ì„œ
   - `GET /api/auth/me` ì„ íƒ
   - Execute í´ë¦­
   - **ì˜ˆìƒ ê²°ê³¼**: 200 OK, ì‚¬ìš©ì ì •ë³´ ë°˜í™˜

3. **ì˜ˆì¸¡ API í…ŒìŠ¤íŠ¸**
   - `POST /api/predict` ì„ íƒ
   - Try it out í´ë¦­
   - ìš”ì²­ Body:
     ```json
     {
       "item_codes": ["TEST001"],
       "top_k": 5,
       "similarity_threshold": 0.7
     }
     ```
   - Execute í´ë¦­
   - **ì˜ˆìƒ ê²°ê³¼**: 200 OK ë˜ëŠ” ì ì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€

### ì‹œë‚˜ë¦¬ì˜¤ 3: í”„ë¡ íŠ¸ì—”ë“œ UI í…ŒìŠ¤íŠ¸

1. `http://localhost:5173` ì ‘ì†
2. ë¡œê·¸ì¸
3. "ë¼ìš°íŒ… ìƒì„±" ë©”ë‰´ í´ë¦­
4. "ì œì–´íŒ" íƒ­ í´ë¦­
5. í’ˆëª© ì„ íƒ
6. "ë¼ìš°íŒ… ì¶”ì²œ ì‹¤í–‰" ë²„íŠ¼ í´ë¦­

**ì„±ê³µ ì¡°ê±´**:
- âœ… "Server response delayed" ì—ëŸ¬ ì—†ìŒ
- âœ… 401 Unauthorized ì—ëŸ¬ ì—†ìŒ
- âœ… ì˜ˆì¸¡ ê²°ê³¼ê°€ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë¨

---

## ğŸ”‘ ì¸ì¦ ì‹œìŠ¤í…œ ë™ì‘ ë°©ì‹

### ë¡œê·¸ì¸ í”Œë¡œìš°
```
1. ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ í¼ ì…ë ¥
   â†“
2. POST /api/auth/login
   â†“
3. ë°±ì—”ë“œê°€ JWT í† í° ìƒì„± í›„ HTTP-only ì¿ í‚¤ë¡œ ì„¤ì •
   â†“
4. í”„ë¡ íŠ¸ì—”ë“œê°€ ì¿ í‚¤ë¥¼ ìë™ìœ¼ë¡œ ì €ì¥
   â†“
5. ì´í›„ ëª¨ë“  API ìš”ì²­ì— ì¿ í‚¤ê°€ ìë™ìœ¼ë¡œ í¬í•¨ë¨
```

### ì¸ì¦ í™•ì¸ í”Œë¡œìš°
```
1. í”„ë¡ íŠ¸ì—”ë“œ í˜ì´ì§€ ë¡œë“œ
   â†“
2. GET /api/auth/me í˜¸ì¶œ (ì¿ í‚¤ ìë™ í¬í•¨)
   â†“
3. ë°±ì—”ë“œê°€ ì¿ í‚¤ì˜ JWT ê²€ì¦
   â†“
4-a. ìœ íš¨: ì‚¬ìš©ì ì •ë³´ ë°˜í™˜ (200 OK)
4-b. ë¬´íš¨ ë˜ëŠ” ì—†ìŒ: 401 Unauthorized
   â†“
5-a. í”„ë¡ íŠ¸ì—”ë“œ: ì¸ì¦ë¨ â†’ ëŒ€ì‹œë³´ë“œ í‘œì‹œ
5-b. í”„ë¡ íŠ¸ì—”ë“œ: ë¯¸ì¸ì¦ â†’ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
```

### API ìš”ì²­ í”Œë¡œìš°
```
1. ì‚¬ìš©ìê°€ "ë¼ìš°íŒ… ì¶”ì²œ ì‹¤í–‰" ë²„íŠ¼ í´ë¦­
   â†“
2. POST /api/predict í˜¸ì¶œ (ì¿ í‚¤ ìë™ í¬í•¨)
   â†“
3. ë°±ì—”ë“œê°€ ì¿ í‚¤ì˜ JWT ê²€ì¦
   â†“
4-a. ìœ íš¨: ì˜ˆì¸¡ ì‹¤í–‰ í›„ ê²°ê³¼ ë°˜í™˜ (200 OK)
4-b. ë¬´íš¨: 401 Unauthorized ë°˜í™˜
   â†“
5-a. í”„ë¡ íŠ¸ì—”ë“œ: ê²°ê³¼ í‘œì‹œ
5-b. í”„ë¡ íŠ¸ì—”ë“œ: "ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤" ê²½ê³  í‘œì‹œ
```

---

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë°±ì—”ë“œ
- [ ] Python ê°€ìƒí™˜ê²½ ì¡´ì¬ í™•ì¸ (`.venv/Scripts/python.exe`)
- [ ] ë°±ì—”ë“œ ì„œë²„ ì‹¤í–‰ (`run_backend_main.bat`)
- [ ] Health check ì„±ê³µ (`http://localhost:8000/health`)
- [ ] Swagger UI ì ‘ì† ê°€ëŠ¥ (`http://localhost:8000/docs`)
- [ ] í¬íŠ¸ 8000 ë¦¬ìŠ¤ë‹ í™•ì¸ (`netstat -ano | findstr :8000`)

### í”„ë¡ íŠ¸ì—”ë“œ
- [ ] Node.js í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ ì¤‘ í™•ì¸ (`tasklist | findstr node`)
- [ ] í”„ë¡ íŠ¸ì—”ë“œ ì ‘ì† ê°€ëŠ¥ (`http://localhost:5173`)
- [ ] API baseURL ì˜¬ë°”ë¦„ (ê°œë°œì ë„êµ¬ > Network íƒ­ì—ì„œ `/api/*` ìš”ì²­ í™•ì¸)

### ì¸ì¦
- [ ] ë¡œê·¸ì¸ í˜ì´ì§€ í‘œì‹œ
- [ ] ë¡œê·¸ì¸ ì„±ê³µ (`POST /api/auth/login` â†’ 200 OK)
- [ ] ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì„±ê³µ (`GET /api/auth/me` â†’ 200 OK)
- [ ] ì¿ í‚¤ ì„¤ì • í™•ì¸ (ê°œë°œì ë„êµ¬ > Application > Cookies)

### ê¸°ëŠ¥
- [ ] ë¼ìš°íŒ… ìƒì„± í˜ì´ì§€ ë¡œë“œ
- [ ] í’ˆëª© ì„ íƒ ê°€ëŠ¥
- [ ] ì˜ˆì¸¡ ì‹¤í–‰ ê°€ëŠ¥ (`POST /api/predict` â†’ 200 OK)
- [ ] ê²°ê³¼ í‘œì‹œ ì •ìƒ

---

## ğŸš€ ë¹ ë¥¸ í•´ê²° (5ë¶„ ì•ˆì—)

```bash
# 1. ëª¨ë“  ì„œë²„ ì¢…ë£Œ
taskkill /F /IM python.exe 2>nul
taskkill /F /IM node.exe 2>nul

# 2. ë°±ì—”ë“œ ì‹œì‘
start cmd /k "run_backend_main.bat"

# 3. 10ì´ˆ ëŒ€ê¸°
timeout /t 10

# 4. í”„ë¡ íŠ¸ì—”ë“œ ì‹œì‘
start cmd /k "run_frontend_prediction.bat"

# 5. ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸
start http://localhost:5173
```

ë¡œê·¸ì¸ í›„ "ë¼ìš°íŒ… ìƒì„±" í´ë¦­ â†’ 401 ì—ëŸ¬ê°€ ì‚¬ë¼ì ¸ì•¼ í•¨

---

## ğŸ“ ì¶”ê°€ ì§€ì›

ì—¬ì „íˆ ë¬¸ì œê°€ í•´ê²°ë˜ì§€ ì•Šìœ¼ë©´:

1. **ë¡œê·¸ í™•ì¸**:
   - ë°±ì—”ë“œ CMD ì°½ì˜ ì „ì²´ ë¡œê·¸ ë³µì‚¬
   - ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ > Console íƒ­ì˜ ì—ëŸ¬ ë³µì‚¬
   - ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ > Network íƒ­ì—ì„œ ì‹¤íŒ¨í•œ ìš”ì²­ í™•ì¸

2. **ì •ë³´ ìˆ˜ì§‘**:
   ```powershell
   # ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤
   tasklist | findstr "python node"

   # í¬íŠ¸ ì‚¬ìš© í˜„í™©
   netstat -ano | findstr ":8000 :5173"

   # ì¿ í‚¤ ìƒíƒœ (ë¸Œë¼ìš°ì € Consoleì—ì„œ)
   document.cookie
   ```

3. **ë¬¸ì˜**:
   - ì´ë©”ì¼: syyun@ksm.co.kr
   - ì „í™”: 010-9718-0580

---

**ë¬¸ì„œ ì‘ì„±**: 2025-10-17
**ì‘ì„±ì**: Claude Code
**ë²„ì „**: 1.0
