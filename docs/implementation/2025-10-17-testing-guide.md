# 프로파일 및 UI 개선사항 테스트 가이드

**날짜**: 2025년 10월 17일
**목적**: 10월 16일 완료된 작업의 기능 테스트

---

## 📋 테스트 개요

10월 16일에 완료된 4가지 주요 작업에 대한 통합 테스트 가이드입니다.

### 테스트 대상
1. ✅ 프로파일 관리 (API 수정 완료)
2. ✅ 데이터 매핑 설정 메뉴
3. ✅ 서버 모니터 v5.2.0
4. ✅ UI 메뉴 재구성

---

## 🚀 사전 준비

### 1. 서버 시작

#### 백엔드 (포트 8000)
```bash
run_backend_main.bat
```

**확인 사항**:
- CMD 창에서 "Uvicorn running on http://0.0.0.0:8000" 메시지 확인
- `http://localhost:8000/docs` 접속하여 Swagger UI 확인

#### 프론트엔드 Home (포트 3000)
```bash
run_frontend_home.bat
```

#### 프론트엔드 Prediction (포트 5173)
```bash
run_frontend_prediction.bat
```

**또는 서버 모니터 사용**:
```bash
dist\RoutingMLMonitor_v5.2.0.exe
```
→ "서버 일괄시작" 버튼 클릭

---

## 🧪 테스트 시나리오

### 시나리오 1: 프로파일 관리 API 테스트

#### 1.1 프로파일 목록 조회
**API 엔드포인트**: `GET /api/data-mapping/profiles`

**PowerShell 테스트**:
```powershell
$response = Invoke-RestMethod -Uri "http://localhost:8000/api/data-mapping/profiles" -Headers @{Authorization="Bearer YOUR_TOKEN"}
$response | ConvertTo-Json -Depth 10
```

**예상 결과**:
```json
{
  "profiles": [...],
  "total": 3
}
```

**성공 조건**:
- ✅ 404 에러 없이 정상 응답
- ✅ `profiles` 배열 반환
- ✅ `total` 값 > 0

#### 1.2 Swagger UI로 테스트
1. `http://localhost:8000/docs` 접속
2. "data-mapping" 태그 확장
3. `GET /api/data-mapping/profiles` 선택
4. "Try it out" 클릭
5. "Execute" 클릭

**성공 조건**:
- ✅ Response code 200
- ✅ Response body에 profiles 리스트 표시

---

### 시나리오 2: 프론트엔드 프로파일 CRUD 테스트

#### 2.1 프로파일 생성
1. `http://localhost:5173` 접속 후 로그인
2. 좌측 메뉴에서 "출력설정" 클릭
3. "Profiles" 탭에서 "New Profile" 버튼 클릭
4. 입력:
   - Profile Name: `테스트 프로파일`
   - Description: `테스트용 프로파일입니다`
   - Default Format: `CSV`
5. "Create Profile" 버튼 클릭

**성공 조건**:
- ✅ 모달 닫힘
- ✅ 프로파일 리스트에 새 프로파일 **즉시 표시**
- ✅ 성공 메시지 표시: "프로파일이 생성되었습니다"
- ✅ 404 에러 없음

#### 2.2 프로파일 수정
1. 생성한 프로파일 선택
2. "Column Mapping" 탭으로 이동
3. "Add Column" 버튼 클릭
4. 매핑 행 추가:
   - Source: `품목코드`
   - Mapped: `ITEM_CODE`
   - Type: `Text`
5. "Save" 버튼 클릭

**성공 조건**:
- ✅ "Output profile saved." 메시지 표시
- ✅ 404 에러 없음
- ✅ "Preview & Export" 탭에서 미리보기 표시

#### 2.3 프로파일 삭제
1. "Profiles" 탭으로 돌아가기
2. 삭제할 프로파일 선택 (테스트 프로파일 아닌 다른 것)
3. 삭제 버튼 클릭 (있을 경우)

**성공 조건**:
- ✅ 프로파일이 리스트에서 제거됨
- ✅ 다른 프로파일로 자동 전환됨

---

### 시나리오 3: 데이터 매핑 설정 메뉴 테스트

#### 3.1 메뉴 접근
1. 관리자 계정으로 로그인
2. 좌측 메뉴에서 "데이터 매핑 설정" 찾기

**성공 조건**:
- ✅ "데이터 매핑 설정" 메뉴가 관리자 섹션에 표시됨
- ✅ 아이콘: Database 또는 Table

#### 3.2 MSSQL 테이블 매핑 확인
1. "데이터 매핑 설정" 클릭
2. "MSSQL 테이블 매핑" 섹션 확인

**성공 조건**:
- ✅ ReferenceMatrixPanel 컴포넌트가 표시됨
- ✅ MSSQL 테이블/컬럼 목록이 로드됨
- ✅ 매핑 설정 UI가 정상 작동

---

### 시나리오 4: 데이터 관계 설정 메뉴 테스트

#### 4.1 공정 그룹 정의 위치 확인
1. 좌측 메뉴에서 "데이터 관계 설정" 클릭
2. 페이지 하단으로 스크롤

**성공 조건**:
- ✅ "공정 그룹 정의" 섹션이 하단에 표시됨
- ✅ RoutingGroupControls 컴포넌트가 embedded 모드로 표시됨
- ✅ 공정 그룹 생성/수정/삭제 기능 정상 작동

#### 4.2 라우팅 생성 페이지 확인
1. 좌측 메뉴에서 "라우팅 생성" 클릭
2. "제어판" 탭 선택

**성공 조건**:
- ✅ 제어판만 표시됨 (간소화됨)
- ✅ MSSQL 미리보기 섹션 **제거**됨
- ✅ 공정 그룹 정의 섹션 **제거**됨

---

### 시나리오 5: 기준정보 페이지 테스트

#### 5.1 품목 검색
1. 좌측 메뉴에서 "기준정보" 클릭
2. 좌측 검색 바에 긴 품목명 입력 (예: "ASSY, SEMICONDUCTOR, CHIP MOUNT, AUTO, ADVANCED")

**성공 조건**:
- ✅ 좌측 패널 너비: 최소 300px
- ✅ 품목명이 깨지지 않고 표시됨
- ✅ 검색 바가 충분히 넓음 (28% 또는 300px)

---

### 시나리오 6: 서버 모니터 v5.2.0 테스트

#### 6.1 정상 시작/종료
1. `dist\RoutingMLMonitor_v5.2.0.exe` 실행
2. "서버 일괄시작" 버튼 확인

**성공 조건**:
- ✅ 시작 버튼이 **항상 활성화** 상태
- ✅ 시작 버튼 클릭 시 모든 서비스 시작됨
- ✅ 중지 버튼은 서비스 온라인 시에만 활성화

#### 6.2 비정상 종료 복구
1. "서버 일괄시작" 버튼 클릭하여 서비스 시작
2. CMD 창 중 하나를 강제로 닫기 (X 버튼)
3. 5초 대기 (상태 폴링)
4. "서버 일괄시작" 버튼 상태 확인

**성공 조건**:
- ✅ 시작 버튼이 **여전히 활성화** 상태
- ✅ 시작 버튼 클릭으로 서비스 재시작 가능
- ✅ 사용자가 버튼이 비활성화되어 막히지 않음

#### 6.3 포트 기반 강제 종료
1. 서비스들이 실행 중인 상태에서 "서버 일괄정지" 버튼 클릭
2. PowerShell에서 포트 확인:
```powershell
netstat -ano | findstr ":8000"
netstat -ano | findstr ":8001"
netstat -ano | findstr ":8002"
netstat -ano | findstr ":3000"
netstat -ano | findstr ":5173"
```

**성공 조건**:
- ✅ 모든 포트가 해제됨 (결과 없음)
- ✅ CMD 창이 모두 닫힘
- ✅ taskkill로 프로세스 트리가 완전히 종료됨

---

## 🐛 알려진 이슈 및 해결 방법

### 이슈 1: 프로파일 목록 404 에러

**증상**:
```
GET /api/api/data-mapping/profiles 404 Not Found
```

**원인**: API URL 중복 (`/api` prefix 2번 추가)

**해결 확인**:
- [x] `ProfileManagement.tsx:27` - `/data-mapping/profiles` (수정됨)
- [x] `ProfileEditor.tsx:38` - `/data-mapping/profiles/{id}` (수정됨)
- [x] `backend/api/app.py:69` - data_mapping_router 등록 (완료)

**복구 방법**:
1. 백엔드 재시작: `run_backend_main.bat`
2. 브라우저 캐시 삭제 (Ctrl+Shift+Del)
3. 페이지 새로고침 (Ctrl+F5)

---

### 이슈 2: 프로파일 생성 후 리스트 미업데이트

**증상**:
- 프로파일 생성 후 모달이 닫히지만 리스트에 표시 안 됨

**원인**: `refresh()` 호출이 모달 닫기 이후에 실행됨

**해결 확인**:
- [x] `DataOutputWorkspace.tsx:676` - `await profilesQuery.refresh()` 먼저 호출 (수정됨)

**복구 방법**:
1. 페이지 새로고침 (F5)
2. 다른 메뉴 갔다가 다시 "출력설정" 클릭

---

### 이슈 3: 서버 모니터 시작 버튼 비활성화

**증상**:
- 서버 비정상 종료 후 시작 버튼이 회색으로 비활성화됨

**원인**: 이전 버전(v5.1.0)의 엄격한 조건 (모든 서비스 offline일 때만 활성화)

**해결 확인**:
- [x] `server_monitor_dashboard_v5_1.py:318` - 초기 상태 `enabled=True` (수정됨)
- [x] `server_monitor_dashboard_v5_1.py:1134-1136` - 항상 활성화 로직 (수정됨)

**복구 방법**:
1. v5.2.0 재다운로드: `dist\RoutingMLMonitor_v5.2.0.exe`
2. 실행 후 시작 버튼 활성화 상태 확인

---

## ✅ 테스트 체크리스트

### 프로파일 관리
- [ ] 프로파일 목록 조회 (404 에러 없음)
- [ ] 프로파일 생성 (즉시 리스트 업데이트)
- [ ] 프로파일 수정 (매핑 저장)
- [ ] 프로파일 삭제
- [ ] 프로파일 선택 시 자동 로드

### UI 메뉴
- [ ] "데이터 매핑 설정" 메뉴 표시 (관리자)
- [ ] MSSQL 테이블 매핑 UI 정상 작동
- [ ] "데이터 관계 설정" 하단에 공정 그룹 정의 표시
- [ ] 라우팅 생성 > 제어판 간소화 확인

### 기준정보
- [ ] 좌측 패널 너비 300px 이상
- [ ] 긴 품목명 깨지지 않음

### 서버 모니터
- [ ] v5.2.0 버전 표시 확인
- [ ] 시작 버튼 항상 활성화
- [ ] 비정상 종료 후 재시작 가능
- [ ] 일괄정지로 모든 포트 해제

### 전체 통합
- [ ] 백엔드 → 프론트엔드 API 통신 정상
- [ ] 프로파일 CRUD 전체 플로우 정상
- [ ] 메뉴 구조 직관적으로 개선됨

---

## 📊 테스트 결과 기록

### 테스트 실행 정보
- **테스트 날짜**: ___________
- **테스트 환경**: Windows 10/11, Chrome/Edge
- **테스터**: ___________

### 결과 요약
| 시나리오 | 결과 | 비고 |
|----------|------|------|
| 프로파일 API 테스트 | ☐ 성공 ☐ 실패 | |
| 프로파일 CRUD | ☐ 성공 ☐ 실패 | |
| 데이터 매핑 설정 메뉴 | ☐ 성공 ☐ 실패 | |
| 데이터 관계 설정 | ☐ 성공 ☐ 실패 | |
| 기준정보 페이지 | ☐ 성공 ☐ 실패 | |
| 서버 모니터 v5.2.0 | ☐ 성공 ☐ 실패 | |

### 발견된 버그
1. _____________________
2. _____________________
3. _____________________

---

## 📞 문의 및 보고

**버그 발견 시**:
- 스크린샷 + 재현 단계 기록
- `docs/implementation/2025-10-17-bug-report.md` 파일 생성

**이메일**: syyun@ksm.co.kr
**전화**: 010-9718-0580

---

**문서 작성**: 2025-10-17
**작성자**: Claude Code
**버전**: 1.0
